<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Absensi | E-Learning RPL</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
:root{
 --primary:#34d399;
 --secondary:#10b981;
 --dark:#064e3b;
 --glass:rgba(255,255,255,.75);
}

*{box-sizing:border-box}

body{
 margin:0;
 font-family:'Poppins',sans-serif;
 background:
  radial-gradient(circle at top left,#bbf7d0,transparent 40%),
  radial-gradient(circle at bottom right,#99f6e4,transparent 40%),
  linear-gradient(180deg,#ecfdf5,#f8fdfb);
 color:var(--dark);
 min-height:100vh;
}

/* ================= NAVBAR (JANGAN DIUBAH) ================= */
nav{
 position:fixed;
 top:0;left:0;width:100%;
 z-index:99;
 background:rgba(255,255,255,.9);
 backdrop-filter:blur(18px);
 padding:14px 36px;
 display:flex;
 justify-content:space-between;
 align-items:center;
 box-shadow:0 8px 24px rgba(0,0,0,.08);
}

.brand{
 display:flex;
 align-items:center;
 gap:12px;
 font-weight:800;
 font-size:18px;
}

.brand img{width:40px;border-radius:50%}

.nav-user{
 display:flex;
 align-items:center;
 gap:12px;
 font-size:14px;
 font-weight:600;
}

#absenStatus{
 font-size:12px;
 padding:6px 14px;
 border-radius:30px;
}

.status-belum{background:#fef3c7;color:#92400e}
.status-sudah{background:#dcfce7;color:#166534}

/* ================= CONTENT ================= */
section{
 padding:160px 20px 80px;
 display:flex;
 justify-content:center;
}

.container{
 width:100%;
 max-width:820px;
 background:var(--glass);
 backdrop-filter:blur(22px);
 border-radius:36px;
 padding:56px 48px;
 box-shadow:
  0 30px 80px rgba(0,0,0,.15),
  inset 0 0 0 1px rgba(255,255,255,.6);
 animation:cardIn .9s cubic-bezier(.2,.8,.2,1);
}

@keyframes cardIn{
 from{
  opacity:0;
  transform:translateY(60px) scale(.95);
 }
 to{
  opacity:1;
  transform:none;
 }
}

h2{
 text-align:center;
 font-size:34px;
 font-weight:800;
 margin-bottom:10px;
}

.desc{
 text-align:center;
 font-size:14px;
 color:#64748b;
 margin-bottom:48px;
}

/* ================= FORM ================= */
.form-grid{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:28px;
}

.form-group{display:flex;flex-direction:column}

.form-group.full{grid-column:1/3}

label{
 font-weight:600;
 font-size:13px;
 display:flex;
 align-items:center;
 gap:8px;
 margin-bottom:8px;
 color:#065f46;
}

label i{color:var(--secondary)}

input,select{
 padding:16px 18px;
 border-radius:18px;
 border:1px solid rgba(0,0,0,.08);
 background:rgba(255,255,255,.85);
 font-size:14px;
 transition:.25s ease;
}

input:focus,select:focus{
 outline:none;
 border-color:var(--primary);
 box-shadow:0 0 0 4px rgba(52,211,153,.25);
 transform:translateY(-1px);
}

input[readonly]{
 background:#f1f5f9;
 color:#64748b;
}

/* ================= BUTTON ================= */
.submit-btn{
 margin-top:40px;
 width:100%;
 padding:20px;
 border-radius:999px;
 border:0;
 font-size:16px;
 font-weight:700;
 color:#fff;
 cursor:pointer;
 background:linear-gradient(135deg,#6ee7b7,#34d399);
 box-shadow:0 18px 40px rgba(16,185,129,.35);
 transition:.3s ease;
}

.submit-btn:hover{
 transform:translateY(-3px);
 box-shadow:0 28px 60px rgba(16,185,129,.45);
}

/* ================= FOOTER (JANGAN DIUBAH) ================= */
footer{
 background:#064e3b;
 color:#ecfeff;
 text-align:center;
 padding:22px;
 font-size:13px;
}

/* ================= RESPONSIVE ================= */
/* Tablet (481px - 768px) */
@media (max-width: 768px) {
 .container {
  padding: 48px 36px;
  border-radius: 28px;
 }
 h2 {
  font-size: 28px;
 }
 .desc {
  font-size: 13px;
  margin-bottom: 36px;
 }
 .form-grid {
  gap: 24px;
 }
 input, select {
  padding: 14px 16px;
  font-size: 13px;
 }
 .submit-btn {
  margin-top: 32px;
  padding: 18px;
  font-size: 15px;
 }
 nav {
  padding: 12px 24px;
 }
 .brand {
  font-size: 16px;
 }
 .brand img {
  width: 36px;
 }
 .nav-user {
  font-size: 13px;
  gap: 10px;
 }
 #absenStatus {
  font-size: 11px;
  padding: 5px 12px;
 }
}

/* Mobile (max-width: 480px) */
@media (max-width: 480px) {
 .container {
  padding: 40px 28px;
  border-radius: 24px;
 }
 .form-grid {
  grid-template-columns: 1fr;
  gap: 20px;
 }
 .form-group.full {
  grid-column: auto;
 }
 h2 {
  font-size: 24px;
 }
 .desc {
  font-size: 12px;
  margin-bottom: 32px;
 }
 label {
  font-size: 12px;
 }
 input, select {
  padding: 12px 14px;
  font-size: 12px;
 }
 .submit-btn {
  margin-top: 28px;
  padding: 16px;
  font-size: 14px;
 }
 nav {
  padding: 10px 20px;
 }
 .brand {
  font-size: 14px;
  gap: 10px;
 }
 .brand img {
  width: 32px;
 }
 .nav-user {
  font-size: 12px;
  gap: 8px;
 }
 #absenStatus {
  font-size: 10px;
  padding: 4px 10px;
 }
 footer {
  padding: 18px;
  font-size: 12px;
 }
}

/* ===== LOADING SCREEN ===== */
#loadingScreen{
 position:fixed;
 inset:0;
 background:rgba(255,255,255,.65);
 backdrop-filter:blur(18px);
 display:flex;
 align-items:center;
 justify-content:center;
 z-index:9999;
 opacity:0;
 pointer-events:none;
 transition:.4s ease;
}

#loadingScreen.active{
 opacity:1;
 pointer-events:auto;
}

.loader-card{
 background:rgba(255,255,255,.85);
 padding:36px 44px;
 border-radius:28px;
 text-align:center;
 box-shadow:0 30px 80px rgba(0,0,0,.18);
 animation:pop .5s ease;
}

@keyframes pop{
 from{transform:scale(.85);opacity:0}
 to{transform:scale(1);opacity:1}
}

.spinner{
 width:52px;
 height:52px;
 border-radius:50%;
 border:5px solid #d1fae5;
 border-top-color:#10b981;
 animation:spin 1s linear infinite;
 margin:0 auto 18px;
}

@keyframes spin{
 to{transform:rotate(360deg)}
}

#loadingText{
 font-weight:600;
 font-size:14px;
 color:#065f46;
}

</style>
</head>

<body>

<!-- NAVBAR (TETAP) -->
<nav>
 <div class="brand">
  <img src="logo.png">
  SMK AL-HIKMAH GARUT TAROGONG KALER
 </div>
 <div class="nav-user">
  <i class="fa-solid fa-user"></i>
  <span id="navNama">Siswa</span>
  <span id="absenStatus" class="status-belum">⏳ Belum Absen</span>
 </div>
</nav>

<section>
 <div class="container">
  <h2>Absensi Siswa</h2>
  <p class="desc">Isi absensi terlebih dahulu sebelum mengikuti pembelajaran</p>

  <form id="form-absensi">
   <div class="form-grid">

    <div class="form-group">
     <label><i class="fa-solid fa-user"></i> Nama</label>
     <input id="nama" readonly>
    </div>

    <div class="form-group">
     <label><i class="fa-solid fa-id-card"></i> NIS</label>
     <input id="nis" readonly>
    </div>

    <div class="form-group">
     <label><i class="fa-solid fa-school"></i> Kelas</label>
     <select id="kelas">
      <option value="">Pilih</option>
      <option>X</option>
      <option>XI</option>
      <option>XII</option>
     </select>
    </div>

    <div class="form-group">
     <label><i class="fa-solid fa-calendar"></i> Tanggal</label>
     <input type="date" id="tanggal">
    </div>

    <div class="form-group full">
     <label><i class="fa-solid fa-clipboard-check"></i> Status Kehadiran</label>
     <select id="status">
      <option value="">Pilih</option>
      <option value="Hadir">Hadir</option>
      <option value="Sakit">Sakit</option>
      <option value="Izin">Izin</option>
     </select>
    </div>

   </div>

   <button class="submit-btn">Kirim Absensi</button>
  </form>
 </div>
</section>

<footer>
 © 2025 Mahasiswa PTI IPI Garut | SMK Al-Hikmah Tarogong Kaler Garut
</footer>

<!-- ===== LOADING OVERLAY ===== -->
<div id="loadingScreen">
  <div class="loader-card">
    <div class="spinner"></div>
    <p id="loadingText">Mengalihkan...</p>
  </div>
</div>

<script>
const REDIRECT_TIME="pertemuan1.html";
const REDIRECT_HOME="index.html";

const siswaRaw = localStorage.getItem("loginSiswa");

if(!siswaRaw){
 Swal.fire({
  icon:"error",
  title:"Akses Ditolak",
  text:"Silakan login terlebih dahulu"
 }).then(()=>{
  location.href="index.html";
 });
}

const siswa = JSON.parse(siswaRaw);

const nama=document.getElementById("nama");
const nis=document.getElementById("nis");
const kelas=document.getElementById("kelas");
const tanggal=document.getElementById("tanggal");
const status=document.getElementById("status");
const badge=document.getElementById("absenStatus");
const navNama=document.getElementById("navNama");
const form=document.getElementById("form-absensi");

const loading=document.getElementById("loadingScreen");
const loadingText=document.getElementById("loadingText");

// Isi form (nama disamarkan)
nama.value = "Siswa";
nis.value = siswa.nis; // NIS tetap boleh tampil (opsional)

// Navbar tetap "Siswa"
navNama.textContent = "Siswa";

// Tanggal otomatis hari ini
tanggal.valueAsDate = new Date();

// Status awal
badge.textContent = "⏳ Belum Absen";
badge.className = "status-belum";

/* ===== MESSAGE & REDIRECT ===== */
function hasilAbsensi(st){
 if(st==="Hadir"){
  return {
   msg:"Mengalihkan ke pembelajaran...",
   redirect:REDIRECT_TIME
  };
 }
 if(st==="Sakit"){
  return {
   msg:"Mengalihkan ke beranda...",
   redirect:REDIRECT_HOME
  };
 }
 if(st==="Izin"){
  return {
   msg:"Mengalihkan ke beranda...",
   redirect:REDIRECT_HOME
  };
 }
}

/* ===== SUBMIT ===== */
form.addEventListener("submit",e=>{
 e.preventDefault();

 if(!kelas.value||!tanggal.value||!status.value){
  Swal.fire("Lengkapi Data","Semua field wajib diisi","warning");
  return;
 }

 const hasil=hasilAbsensi(status.value);

 badge.textContent="✅ Sudah Absen";
 badge.className="status-sudah";

 Swal.fire({
  icon:"success",
  title:"Absensi Tersimpan",
  text: hasil.msg,
  timer:1600,
  showConfirmButton:false
 }).then(()=>{
  // TAMPILKAN LOADING
  loadingText.textContent=hasil.msg;
  loading.classList.add("active");

  setTimeout(()=>{
   window.location.href=hasil.redirect;
  },2000);
 });
});
</script>
</body>
</html>
